---
layout: post
title: 변수의 초기화
description: Java의 정석 기초편 ch. 6 객체지향 프로그래밍 1
categories: Java
date: 2023-04-11 15:51:00 +09:00
---
변수를 선언하고 처음으로 값을 저장하는 것을 '**변수의 초기화**'라고 한다. 변수의 초기화는 경우에 따라서 필수적이기도 하고 선택적이기도 하지만, 가능하면 선언과 동시에 적절한 값으로 초기화 하는 것이 바람직하다.

멤버변수는 초기화를 하지 않아도 자동적으로 변수의 자료형에 맞는 기본값으로 초기화가 이루어지므로 초기화하지 않고 사용해도 되지만, **지역변수는 사용하기 전에 반드시 초기화해야 한다**.

```java
class InitTest {
  int x;        // 인스턴스 변수
  int y;        // 인스턴스 변수
  
  void method1() {
    int i;      // 지역변수
    int j = i;  // ERROR. 지역변수를 초기화하지 않고 사용
  }
}
```

위의 코드에서 x, y는 인스턴스 변수이고, i, j는 지역변수이다. 그 중 x와 i는 선언만 하고 초기화를 하지 않았다. 그리고 y를 초기화 하는데 x를 사용하였고, j를 초기화 하는데 i를 사용하였다.

인스턴스 변수 x는 초기화를 해주지 않아도 자동적으로 int형의 기본값인 0으로 초기화되므로, 'int y = x;'와 같이 할 수 있다. x의 값이 0이므로 y 역시 0으로 저장된다.

하지만, method1()의 지역변수 i는 자동적으로 초기화되지 않으므로, 초기화 되지 않은 상태에서 변수 j를 초기화 하는데 사용될 수 없다. 컴파일하면 에러가 발생한다.

> 멤버변수(클래스 변수, 인스턴스 변수)와 배열의 초기화는 선택이지만, 지역변수의 초기화는 필수이다.

참고로 각 타입의 기본값(default value)은 다음과 같다.

|자료형|기본값|
|:---:|:---:|
|boolean|false|
|char|'\u0000'|
|byte, short, int|0|
|long|0L|
|float|0.0f|
|double|0.0d 또는 0.0|
|참조형|null|


### 멤버변수의 초기화

지역변수와 달리 멤버변수는 각 타입의 기본값으로 자동 초기화 된다. 그 다음에 명시적 초기화, 초기화 블럭, 생성자의 순서로 초기화 된다. 그리고 클래스 변수(cv)가 인스턴스 변수(iv)보다 먼저 초기화 된다. 멤버변수의 초기화에 대해서는 이 두 가지만 기억하면 된다.

> 1. 클래스 변수(cv) 초기화 -> 인스턴스 변수(iv) 초기화
> 2. 자동 초기화 -> 명시적 초기화(간단) -> 초기화 블럭, 생성자(복잡)


### 명시적 초기화(explicit initialization)

변수를 선언함과 동시에 초기화하는 것을 명시적 초기화라고 한다. 가장 기본적이면서도 간단한 초기화 방법이므로 여러 초기화 방법 중에서 가장 우선적으로 고려되어야 한다.

```java
class Car {
  int door = 4;             // 기본형(primitive type) 변수의 초기화
  Engine e = new Engine();  // 참조형(reference type) 변수의 초기화
}
```

명시적 초기화가 간단하고 명료하긴 하지만, 보다 복잡한 초기화 작업이 필요할 때는 '초기화 블럭(initialization block)' 또는 생성자를 사용해야 한다.


### 초기화 블럭(initialization block)

초기화 블럭에는 '클래스 초기화 블럭'과 '인스턴스 초기화 블럭' 두 가지 종류가 있다. 클래스 초기화 블럭은 클래스 변수의 초기화에 사용되고, 인스턴스 초기화 블럭은 인스턴스 변수의 초기화에 사용된다.

> 클래스 초기화 블럭 - 클래스 변수의 복잡한 초기화에 사용된다.\
> 인스턴스 초기화 블럭 - 인스턴스 변수의 복잡한 초기화에 사용된다.

초기화 블럭을 작성하려면, 인스턴스 초기화 블럭은 단순히 클래스 내에 블럭{}을 만들고 그 안에 코드를 작성하기만 하면 된다. 그리고 클래스 초기화 블럭은 인스턴스 초기화 블럭 앞에 단순히 static을 덧붙이기만 하면 된다.


### 멤버변수의 초기화 예제 1

```java
class Ex6_14 {
	static {
		System.out.println("static { }");	// 클래스 초기화 블럭 
	}

	{
		System.out.println("{ }");	// 인스턴스 초기화 블럭 
	}

	public Ex6_14() {
		System.out.println("생성자");
	}

	public static void main(String args[]) {
		System.out.println("Ex6_14 bt = new Ex6_14(); ");
		Ex6_14 bt = new Ex6_14();

		System.out.println("Ex6_14 bt2 = new Ex6_14(); ");
		Ex6_14 bt2 = new Ex6_14();
	}
}
```

위 코드의 출력 결과는 다음과 같다.

```
static { }
Ex6_14 bt = new Ex6_14(); 
{ }
생성자
Ex6_14 bt2 = new Ex6_14(); 
{ }
생성자
```

예제가 실행되면서 Ex6_14이 메모리에 로딩될 때, 클래스 초기화 블럭이 가장 먼저 수행되어 'static { }'이 화면에 출력된다. 그 다음에 main메서드가 수행되어 Ex6_14의 인스턴스가 생성되면서 인스턴스 초기화 블럭이 먼저 수행되고, 끝으로 생성자가 수행된다. 

위의 실행 결과에서도 알 수 있듯이 **클래스 초기화 블럭은 처음 메모리에 로딩될 때 한 번만 수행되었지만, 인스턴스 초기화 블럭은 인스턴스가 생성될 때마다 수행되었다**.


### 멤버변수의 초기화 예제 2

```java
class Ex6_15 {
	static int[] arr = new int[10];

	static {
		for(int i=0;i<arr.length;i++) {
			// 1과 10 사이의 임의의 값을 배열 arr에 저장한다. 
			arr[i] = (int)(Math.random()*10) + 1;
		}
	}

	public static void main(String args[]) {
		for(int i=0; i<arr.length;i++)
			System.out.println("arr["+i+"] :" + arr[i]);
	}
}
```

위 코드의 출력 결과는 다음과 같다.

```
arr[0] :3
arr[1] :9
arr[2] :4
arr[3] :2
arr[4] :1
arr[5] :4
arr[6] :8
arr[7] :10
arr[8] :2
arr[9] :5
```

명시적 초기화를 통해 배열 arr을 생성하고, 클래스 초기화 블럭을 이용해서 배열의 각 요소들을 random()을 사용해서 임의의 값으로 채우도록 했다.

이처럼 배열이나 예외처리가 필요한 초기화에서는 명시적 초기화만으로는 복잡한 초기화 작업을 할 수 없다. 이런 경우에 추가적으로 클래스 초기화 블럭을 사용하도록 한다.
