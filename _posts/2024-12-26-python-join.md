---
layout: post
title: 파이썬 리스트와 join
categories: Python
date: 2024-12-26 09:43:00 +0900
---
파이썬에서 리스트의 요소들을 문자열로 출력하고 싶을 때, ```join``` 함수를 사용하는 것이 바람직하다.

## 문자열 누적 방식의 문제점

가령 이중 연결 리스트의 요소들을 합쳐서 문자열로 출력한다고 해보자.

```python
def desc(self):
    ans = ''
    node = self.head
    while node:
        ans += node.data  # 기존 문자열에 새로운 문자를 추가
        node = node.next
    print(ans)
```

위와 같은 방식으로 ```ans``` 라는 빈 문자열을 생성하고, 노드의 데이터 값을 ```ans``` 에 누적할 수 있다. (노드의 데이터가 문자 자료형이기 때문에 ```str()```로 형변환을 따로 하지 않았다.)

그런데 이런 방식을 사용하면 입력 문자열이 길어질수록 시간이 급격히 증가하여 시간 초과가 발생할 수 있다.

파이썬(Python)의 문자열은 불변(immutable) 자료형이다. 따라서 ```ans``` 에 새로운 문자를 추가할 때마다 새로운 문자열 객체를 생성해야 한다.

즉, ```ans += node.data``` 를 수행할 때마다,

1. 기존 문자열 ```ans```를 복사
2. ```node.data``` 를 복사
3. 두 문자열을 합쳐 새로운 문자열을 생성

하는 것이다.

이 과정은 매번 O(L) 의 연산을 수행한다. 여기서 L 은 ```ans``` 의 현재 길이이다.

이때 시간 복잡도를 계산하면 다음과 같다.

* 문자열 길이가 N 이고 노드를 N 번 순회한다면,
    * 첫 번째 문자를 추가하는 데에는 O(1)
    * 두 번째 문자를 추가하는 데에는 O(2)
    * ...
    * N 번째 문자를 추가하는 데에는 O(N)

그러면 총 복잡도는 O(1 + 2 + 3 + ... + N) = <b>O(N²)</b> 인 것이다. 문자열 누적 방식을 사용할 경우, 입력 문자열의 길이가 10⁵ 이상이라면 O(N²) 의 시간 복잡도로는 시간 초과가 발생하게 된다.

<br>

<hr>

## 개선된 코드 : 리스트와 join 사용

위에서 다뤘던 desc() 메서드를 파이썬의 리스트와 ```join()``` 메서드를 사용하여 개선해 보겠다.

개선된 코드는 다음과 같다.

```python
def desc(self):
    result = []
    node = self.head
    while node:
        result.append(node.data)  # 리스트에 데이터를 추가 (O(1))
        node = node.next
    print("".join(result))  # 리스트를 문자열로 변환 (O(N))
```

파이썬의 리스트에 대해 ```join()``` 메서드를 사용하려면, 리스트에 들어있는 값들의 자료형이 문자형이어야 한다. 만약 문자형이 아닌, 다른 자료형이면 먼저 문자형으로 형변환을 해줘야 한다.

개선된 방식의 핵심은 다음과 같다.

* <b>리스트의 동적 배열 구현</b> : Python 의 리스트는 데이터를 추가할 때 O(1) 의 복잡도로 처리한다.

* <b>문자열 변환 최적화</b> : 모든 데이터를 한 번에 ```.join(result)``` 를 호출하여 문자열로 변환하므로 전체 연산은 O(N) 이다.

결과적으로 총 시간 복잡도는 <b>O(N)</b> 이다.

<br>
<hr>

## 비교 : 기존 코드와 개선된 코드

<table>
    <tr>
        <th>항목</th>
        <th>기존 코드</th>
        <th>개선된 코드</th>
    </tr>
    <tr>
        <td>문자열 생성 방식</td>
        <td>매번 새 문자열 생성</td>
        <td>리스트에 데이터 추가</td>
    </tr>
    <tr>
        <td>문자열 변환 비용</td>
        <td>O(N²)</td>
        <td>O(N)</td>
    </tr>
    <tr>
        <td>데이터 구조</td>
        <td>문자열 +=</td>
        <td>리스트와 <b>join</b></td>
    </tr>
    <tr>
        <td>시간 초과 가능성</td>
        <td>입력이 클수록 발생</td>
        <td>시간 초과 없음</td>
    </tr>
</table>