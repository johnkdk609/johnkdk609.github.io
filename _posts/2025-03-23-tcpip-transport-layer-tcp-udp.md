---
layout: post
title: TCP/IP 4계층 &#35;4. 전송 계층(transport) TCP, UDP
categories: Network
description: CS 지식의 정석 - 디자인패턴 네트워크 운영체제 데이터베이스 자료구조
date: 2025-03-23 23:17:00 +0900
---
전송 계층(transport layer)에서는 TCP, UDP가 대표적이며 애플리케이션 계층에서 받은 메시지를 기반으로 세그먼트 또는 데이터그램으로 데이터를 쪼개고 데이터가 오류 없이 순서대로 전달되도록 도움을 주는 층이다.

## TCP

TCP는 <b>가상회선패킷교환방식</b>을 사용한다.

<img src="/assets/img/captures/33b83e2e-4173-4545-a9d7-0417065e67a9.png" width="450px" />

송신 호스트에서 수신 호스트에게 데이터를 보낸다고 했을 때 위와 같이 가상 회선을 만들고, 이것을 기반으로 순서대로 보낸다. 1 → 2 → 3 순서대로 도착을 한다. 이것이 가상회선을 기반으로 패킷을 보내는 것이다.

<br>

TCP는 <b>오류검사 메커니즘이 다양하다.</b>

1. <b>재전송</b> : 시간 초과 기간이 지나면 서버는 전달되지 않은 데이터에 대해 재전송을 시도한다.
2. <b>체크섬</b> : 체크섬을 통해 무결성을 평가한다. 즉, 송신된 데이터의 체크섬과 수신된 데이터의 체크섬 값을 비교해서 올바르게 왔는지를 확인하는 것이다.

내가 어떤 사람에게 데이터를 보낸다고 해보자. 그런데 이 데이터를 보낼 때 갑자기 과도한 트래픽이 발생했다. 이로 인해 데이터를 보내는 작업이 멈췄고, 상대가 5초를 기다린다고 했는데 5초 안에 못 갔다. 그러면 TCP를 이용하는 경우에는 다시 한 번 기회를 준다. 재전송을 보장해서 오류검사를 하는 것이다.

또, 체크섬을 통해 무결성을 평가하는데 무결성이란 '데이터가 올바르게 왔는가' 이다. 내가 송신할 때에 동그라미를 보냈는데, 수신했을 때 반원이 오면 안 된다. 송신할 때의 데이터와 수신할 때의 데이터가 같아야 한다는 것이다. 이것을 보장하는 것이 무결성이다.

<img src="/assets/img/captures/57d6a56b-9a7c-436d-88f8-8a2700e4f512.png" width="360px" />

위 그림을 보자. 체크섬의 경우, checksum function을 사용해 데이터를 기반으로 어떤 값을 만든다. 이 값이 '체크섬'이다. 즉 Input 값을 checksum function을 사용해서 체크섬 값으로 만드는 것이다.

<br>

<b>TCP Header</b> 에 대해 보자.

<img src="/assets/img/captures/8ef89983-0fe6-43c6-b283-f880484c0918.png" width="500px" />

이것저것 정보가 많다. 중요한 것은 TCP는 20 ~ 60 바이트로 가변적이라는 것이다.

<br>
<hr>

## UDP

UDP는 <b>데이터그램패킷교환방식</b>을 사용한다.

<img src="/assets/img/captures/5276a83a-d780-4495-a252-5d2bb95c1449.png" width="450px" />

이전에 TCP는 가상회선을 기반으로 '순서대로' 패킷이 이동했다. 반면 UDP는 '그냥' 보낸다. 그래서 위 그림을 보면 패킷의 도착 순서가 보장되지 않는다.

그리고 <b>UDP는 오류 검사로 체크섬만 지원한다. 재전송은 지원하지 않는다.</b>

<br>

<b>UDP Header는 8바이트(32비트)로 고정 길이</b>를 가진다. TCP 헤더가 20 ~ 60 바이트의 가변 길이를 가지는 것과 차이가 있다.

<img src="/assets/img/captures/feed8dd2-aed9-4814-a211-85143d800a0a.png" width="450px" />

<br>
<hr>

## TCP 와 UDP 비교

TCP와 UDP를 비교한 것을 표로 정리하면 다음과 같다.

<img src="/assets/img/captures/5b03c3d1-7971-4ebd-83eb-c9a4547670b7.png" width="500px" />

신뢰성의 경우 3-Way-Hanshake 라는 개념을 알아야 한다. TCP의 경우 연결을 할 때마다 3-Way-Hanshake 를 수행한다. 장치와 장치 간에 데이터를 보낼 때, 수신 측에서 무조건 받는 것이 아니다. 둘이 '연결되어 있음이 보장'되어야 한다. TCP는 3-Way-Handshake 라는 과정을 통해 송신측과 수신측의 연결을 구축한다. 그래서 TCP는 신뢰성이 있다고 하는 것이고, UDP는 이러한 과정이 없어서 신뢰성이 없다고 하는 것이다.

연결보장의 경우 TCP는 3-Way-Handshake로 연결을 맺고, 4-Way-Handshake로 연결을 해제하는 작업이 필요하다. 반면 UDP는 연결을 보장하지 않기 때문에 그냥 데이터를 보낸다. 그렇기 때문에 장점이 생기는데, 연결을 유지하고 연결을 해제하는 데 드는 비용이 없다.

이러한 TCP와 UDP의 차이점들은 외워야 한다.