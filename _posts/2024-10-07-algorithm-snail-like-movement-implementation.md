---
layout: post
title: 달팽이 움직임 구현
categories: Algorithm
date: 2024-10-07 22:27:00 +0900
---
알고리즘 문제를 풀다 보면 달팽이(snail)의 모양으로 움직이는 객체가 자주 등장한다. 가령 2차원 배열의 중심에서, 시계방향으로 점점 반지름을 키워가며 채워 나가는 것이다.

'달팽이 기법'을 구현하는 방법은 다양하다. 그런데 나는 나만의 기법이 있다.

## 시계방향 확산 달팽이

N × N 크기의 2차원 배열이 있고, 중앙에서 시작해 시계방향으로 점점 커지는 달팽이가 있다고 하자. (N은 3 이상의 홀수이다.) 처음 중앙에서는 바로 위 방향으로 시작한다. 그리고 2차원 배열의 (0, 0) 지점에 도달하면 종료된다.

이러한 달팽이를 구현하려면, 한 칸 움직일 때마다 <b>"오른쪽으로 방향을 꺾을 수 있으면 꺾고, 불가능하면 직진한다"</b> 를 체크하면 된다.

방문 체크 배열을 사용하여 방문한 지점마다 방문 체크를 하면서, 한 칸 움직일 때마다 오른쪽으로 꺾어서 한 칸 간 곳이 아직 방문하지 않은 곳인지 보는 것이다. 이러한 로직으로 작동하기 때문에 '시계방향 확산 달팽이' 에서는 경계 체크(out of bounds)를 따로 하지 않아도 된다. 그냥 현재 지점이 (0, 0) 에 도달하면 종료하거나 다른 작업을 하면 되는 것이다.

이러한 로직으로 작성한 시계방향 확산 달팽이는 다음과 같다.

```python
def clockwise_spreading_snail(v):
    global sr, sc, cur_d
    nr = sr + dr[cur_d]
    nc = sc + dc[cur_d]
    sr, sc = nr, nc     # 달팽이의 행, 열 좌표 업데이트
    v[sr][sc] = 1       # 외부에서 받은 방문 체크 배열에 한 칸 나아간 지점 방문 체크

    # 이제 오른쪽으로 방향 꺾을 수 있는지 여부 파악한다.
    tmp_d = (cur_d + 1) % 4
    nr = sr + dr[tmp_d]
    nc = sc + dc[tmp_d]
    if v[nr][nc] == 0:      # 오른쪽으로 꺾고 한 칸 진행했는데 방문한 적 없는 곳이면, 방향을 바로 꺾는다.
        cur_d = tmp_d

    return v


N = 3   # 3 이상의 홀수 값 아무거나 설정하면 된다.
visited = [[0 for _ in range(N)] for _ in range(N)]

sr, sc = N // 2, N // 2     # 시작 지점 - 2차원 배열의 정중앙
cur_d = 0   # 현재 방향 (↑)

# delta - 상 우 하 좌 (시계방향)
dr = [-1, 0, 1, 0]
dc = [0, 1, 0, -1]

visited[sr][sc] = 1     # 일단 시작 지점 (정중앙) 방문 체크

while True:
    visited = clockwise_spreading_snail(visited)
    print(*visited, sep='\n')
    print('==========')
    if sr == 0 and sc == 0:
        break
```

위 코드의 출력 결과는 다음과 같다. 

```
[0, 1, 0]
[0, 1, 0]
[0, 0, 0]
==========
[0, 1, 1]
[0, 1, 0]
[0, 0, 0]
==========
[0, 1, 1]
[0, 1, 1]
[0, 0, 0]
==========
[0, 1, 1]
[0, 1, 1]
[0, 0, 1]
==========
[0, 1, 1]
[0, 1, 1]
[0, 1, 1]
==========
[0, 1, 1]
[0, 1, 1]
[1, 1, 1]
==========
[0, 1, 1]
[1, 1, 1]
[1, 1, 1]
==========
[1, 1, 1]
[1, 1, 1]
[1, 1, 1]
==========
```

정중앙 (N // 2, N // 2) 에서 시작해서 시계방향으로 달팽이와 같이 움직이는 것을 파악할 수 있다. 메인에서 현재 지점이 (0, 0) 이면 while 문을 break 하도록 설정했다.

<br>

## 반시계방향 수렴 달팽이

