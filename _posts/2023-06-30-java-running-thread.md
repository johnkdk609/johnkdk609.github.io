---
layout: post
title: 쓰레드의 실행 start()와 run()
description: Java의 정석 기초편 ch. 13 쓰레드
categories: Java
date: 2023-06-30 15:14:00 +0900
---
쓰레드를 생성했다고 해서 자동으로 실행되는 것은 아니다. start()를 호출해야만 쓰레드가 실행된다.

```java
t1.start();     // 쓰레드 t1을 실행시킨다.
t2.start();     // 쓰레드 t2를 실행시킨다.
```

사실은 start()가 호출되었다고 해서 바로 실행되는 것이 아니라, 일단 실행대기 상태에 있다가 자신의 차례가 되어야 실행된다. 물론 실행대기중인 쓰레드가 하나도 없으면 곧바로 실행상태가 된다.

(쓰레드의 실행 순서는 OS의 스케쥴러가 작성한 스케쥴에 의해 결정된다.)

한 가지 더 알아두어야 하는 것은 한 번 실행이 종료된 쓰레드는 다시 실행할 수 없다는 것이다. 즉, 하나의 쓰레드에 대해 start()가 한 번만 호출될 수 있다는 뜻이다.

그래서 만일 쓰레드의 작업을 한 번 더 수행해야 한다면 아래의 보기 2 코드와 같이 새로운 쓰레드를 생성한 다음에 start()를 호출해야 한다. 만일 아래 보기 1 코드처럼 하나의 쓰레드에 대해 start()를 두 번 이상 호출하면 실행시에 IllegalThreadStateException이 발생한다.

```java
// 보기 1

ThreadEx1_1 t1 = new ThreadEx1_1();
t1.start();
t1.start();     // 예외 발생
```

```java
// 보기 2

ThreadEx1_1 t2 = new ThreadEx1_1();
t1.start();
t1 = new ThreadEx1_1();     // 다시 생성
t1.start();     // OK
```


## start()와 run()

쓰레드를 실행시킬 때 run()이 아닌 start()를 호출한다는 것에 대해서 다소 의문이 들었을 것이다. 이제 start()와 run()의 차이와 쓰레드가 실행되는 과정에 대해서 자세히 살펴볼 것이다.

main메서드에서 run()을 호출하는 것은 생성된 쓰레드를 실행시키는 것이 아니라 단순히 클래스에 선언된 메서드를 호출하는 것일 뿐이다.

![image](https://github.com/johnkdk609/johnkdk609.github.io/assets/88493727/263c84b9-7535-48ce-b656-de16c7e5ecf5)

위 그림은 main메서드에서 run()을 호출했을 때의 호출스택을 나타낸다.

반면에 start()는 새로운 쓰레드가 작업을 실행하는 데 필요한 호출스택(call stack)을 생성한 다음에 run()을 호출해서, 생성된 호출스택에 run()이 첫 번째로 올라가게 한다.

모든 쓰레드는 독립적인 작업을 수행하기 위해 자신만의 호출스택을 필요로 하기 때문에, 새로운 쓰레드를 생성하고 실행시킬 때마다 새로운 호출스택이 생성되고 쓰레드가 종료되면 작업에 사용된 호출스택은 소멸된다.


![image](https://github.com/johnkdk609/johnkdk609.github.io/assets/88493727/3bd1f875-a93d-4869-9afd-d43f1ce0132e)

① main메서드에서 쓰레드의 start()를 호출한다.\
② start()는 새로운 쓰레드를 생성하고, 쓰레드가 작업하는 데에 사용될 호출스택을 생성한다.\
③ 새로 생성된 호출스택에 run()이 호출되어, 쓰레드가 독립된 공간에서 작업을 수행한다.\
④ 이제는 호출스택이 2개이므로 스케쥴러가 정한 순서에 의해서 번갈아 가면서 실행된다.